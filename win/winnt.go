// winnt.go
package win

import "unsafe"

// 判断操作系统的量
var (
	PROCESSOR_ARCHITECTURE_INTEL          = 0
	PROCESSOR_ARCHITECTURE_MIPS           = 1
	PROCESSOR_ARCHITECTURE_ALPHA          = 2
	PROCESSOR_ARCHITECTURE_PPC            = 3
	PROCESSOR_ARCHITECTURE_SHX            = 4
	PROCESSOR_ARCHITECTURE_ARM            = 5
	PROCESSOR_ARCHITECTURE_IA64           = 6
	PROCESSOR_ARCHITECTURE_ALPHA64        = 7
	PROCESSOR_ARCHITECTURE_MSIL           = 8
	PROCESSOR_ARCHITECTURE_AMD64          = 9
	PROCESSOR_ARCHITECTURE_IA32_ON_WIN64  = 10
	PROCESSOR_ARCHITECTURE_NEUTRAL        = 11
	PROCESSOR_ARCHITECTURE_ARM64          = 12
	PROCESSOR_ARCHITECTURE_ARM32_ON_WIN64 = 13
	PROCESSOR_ARCHITECTURE_IA32_ON_ARM64  = 14

	PROCESSOR_ARCHITECTURE_UNKNOWN = 0xFFFF

	PRODUCT_UNDEFINED = 0x00000000

	PRODUCT_ULTIMATE                     = 0x00000001
	PRODUCT_HOME_BASIC                   = 0x00000002
	PRODUCT_HOME_PREMIUM                 = 0x00000003
	PRODUCT_ENTERPRISE                   = 0x00000004
	PRODUCT_HOME_BASIC_N                 = 0x00000005
	PRODUCT_BUSINESS                     = 0x00000006
	PRODUCT_STANDARD_SERVER              = 0x00000007
	PRODUCT_DATACENTER_SERVER            = 0x00000008
	PRODUCT_SMALLBUSINESS_SERVER         = 0x00000009
	PRODUCT_ENTERPRISE_SERVER            = 0x0000000A
	PRODUCT_STARTER                      = 0x0000000B
	PRODUCT_DATACENTER_SERVER_CORE       = 0x0000000C
	PRODUCT_STANDARD_SERVER_CORE         = 0x0000000D
	PRODUCT_ENTERPRISE_SERVER_CORE       = 0x0000000E
	PRODUCT_ENTERPRISE_SERVER_IA64       = 0x0000000F
	PRODUCT_BUSINESS_N                   = 0x00000010
	PRODUCT_WEB_SERVER                   = 0x00000011
	PRODUCT_CLUSTER_SERVER               = 0x00000012
	PRODUCT_HOME_SERVER                  = 0x00000013
	PRODUCT_STORAGE_EXPRESS_SERVER       = 0x00000014
	PRODUCT_STORAGE_STANDARD_SERVER      = 0x00000015
	PRODUCT_STORAGE_WORKGROUP_SERVER     = 0x00000016
	PRODUCT_STORAGE_ENTERPRISE_SERVER    = 0x00000017
	PRODUCT_SERVER_FOR_SMALLBUSINESS     = 0x00000018
	PRODUCT_SMALLBUSINESS_SERVER_PREMIUM = 0x00000019

	PRODUCT_UNLICENSED = uint64(0xABCDABCD)

	VER_PLATFORM_WIN32s        = 0
	VER_PLATFORM_WIN32_WINDOWS = 1
	VER_PLATFORM_WIN32_NT      = 2

	VER_NT_WORKSTATION       = 0x0000001
	VER_NT_DOMAIN_CONTROLLER = 0x0000002
	VER_NT_SERVER            = 0x0000003

	GENERIC_READ    = 0x80000000
	GENERIC_WRITE   = 0x40000000
	GENERIC_EXECUTE = 0x20000000
	GENERIC_ALL     = 0x10000000

	READ_CONTROL             = 0x00020000
	STANDARD_RIGHTS_REQUIRED = 0x000F0000
	STANDARD_RIGHTS_READ     = READ_CONTROL
	SYNCHRONIZE              = 0x00100000
	PROCESS_ALL_ACCESS       = (STANDARD_RIGHTS_REQUIRED | SYNCHRONIZE | 0xFFFF)

	FILE_SHARE_READ                    = 0x00000001
	FILE_SHARE_WRITE                   = 0x00000002
	FILE_SHARE_DELETE                  = 0x00000004
	FILE_ATTRIBUTE_READONLY            = 0x00000001
	FILE_ATTRIBUTE_HIDDEN              = 0x00000002
	FILE_ATTRIBUTE_SYSTEM              = 0x00000004
	FILE_ATTRIBUTE_DIRECTORY           = 0x00000010
	FILE_ATTRIBUTE_ARCHIVE             = 0x00000020
	FILE_ATTRIBUTE_DEVICE              = 0x00000040
	FILE_ATTRIBUTE_NORMAL              = 0x00000080
	FILE_ATTRIBUTE_TEMPORARY           = 0x00000100
	FILE_ATTRIBUTE_SPARSE_FILE         = 0x00000200
	FILE_ATTRIBUTE_REPARSE_POINT       = 0x00000400
	FILE_ATTRIBUTE_COMPRESSED          = 0x00000800
	FILE_ATTRIBUTE_OFFLINE             = 0x00001000
	FILE_ATTRIBUTE_NOT_CONTENT_INDEXED = 0x00002000
	FILE_ATTRIBUTE_ENCRYPTED           = 0x00004000
	FILE_ATTRIBUTE_VIRTUAL             = 0x00010000
	FILE_NOTIFY_CHANGE_FILE_NAME       = 0x00000001
	FILE_NOTIFY_CHANGE_DIR_NAME        = 0x00000002
	FILE_NOTIFY_CHANGE_ATTRIBUTES      = 0x00000004
	FILE_NOTIFY_CHANGE_SIZE            = 0x00000008
	FILE_NOTIFY_CHANGE_LAST_WRITE      = 0x00000010
	FILE_NOTIFY_CHANGE_LAST_ACCESS     = 0x00000020
	FILE_NOTIFY_CHANGE_CREATION        = 0x00000040
	FILE_NOTIFY_CHANGE_SECURITY        = 0x00000100
	FILE_ACTION_ADDED                  = 0x00000001
	FILE_ACTION_REMOVED                = 0x00000002
	FILE_ACTION_MODIFIED               = 0x00000003
	FILE_ACTION_RENAMED_OLD_NAME       = 0x00000004
	FILE_ACTION_RENAMED_NEW_NAME       = 0x00000005
	MAILSLOT_NO_MESSAGE                = 0xFFFFFFFF
	MAILSLOT_WAIT_FOREVER              = 0xFFFFFFFF
	FILE_CASE_SENSITIVE_SEARCH         = 0x00000001
	FILE_CASE_PRESERVED_NAMES          = 0x00000002
	FILE_UNICODE_ON_DISK               = 0x00000004
	FILE_PERSISTENT_ACLS               = 0x00000008
	FILE_FILE_COMPRESSION              = 0x00000010
	FILE_VOLUME_QUOTAS                 = 0x00000020
	FILE_SUPPORTS_SPARSE_FILES         = 0x00000040
	FILE_SUPPORTS_REPARSE_POINTS       = 0x00000080
	FILE_SUPPORTS_REMOTE_STORAGE       = 0x00000100
	FILE_VOLUME_IS_COMPRESSED          = 0x00008000
	FILE_SUPPORTS_OBJECT_IDS           = 0x00010000
	FILE_SUPPORTS_ENCRYPTION           = 0x00020000
	FILE_NAMED_STREAMS                 = 0x00040000
	FILE_READ_ONLY_VOLUME              = 0x00080000
	FILE_SEQUENTIAL_WRITE_ONCE         = 0x00100000
	FILE_SUPPORTS_TRANSACTIONS         = 0x00200000
	FILE_READ_DATA                     = 0x0001
	FILE_READ_ATTRIBUTES               = 0x0080
	FILE_READ_EA                       = 0x0008
	FILE_GENERIC_READ                  = (STANDARD_RIGHTS_READ | FILE_READ_DATA | FILE_READ_ATTRIBUTES | FILE_READ_EA | SYNCHRONIZE)

	CREATE_NEW        = 1
	CREATE_ALWAYS     = 2
	OPEN_EXISTING     = 3
	OPEN_ALWAYS       = 4
	TRUNCATE_EXISTING = 5

	// begin_wdm
	//
	// Registry Specific Access Rights.
	//

	KEY_QUERY_VALUE        = 0x0001
	KEY_SET_VALUE          = 0x0002
	KEY_CREATE_SUB_KEY     = 0x0004
	KEY_ENUMERATE_SUB_KEYS = 0x0008
	KEY_NOTIFY             = 0x0010
	KEY_CREATE_LINK        = 0x0020
	KEY_WOW64_32KEY        = 0x0200
	KEY_WOW64_64KEY        = 0x0100
	KEY_WOW64_RES          = 0x0300

	//
	// MaximumAllowed access type
	//
	MAXIMUM_ALLOWED = 0x02000000

	ANYSIZE_ARRAY = 1

	SE_TCB_NAME = "SeTcbPrivilege"
)

// begin_ntifs

type SID_IDENTIFIER_AUTHORITY struct {
	Value [6]byte
}

type SID struct {
	Revision            byte
	SubAuthorityCount   byte
	IdentifierAuthority SID_IDENTIFIER_AUTHORITY
	// #ifdef MIDL_PASS
	//    [size_is(SubAuthorityCount)] uint32 SubAuthority[*];
	// #else // MIDL_PASS
	SubAuthority [1]uint32 /*ANYSIZE_ARRAY*/
	// #endif // MIDL_PASS
}

const (
	SID_REVISION                    = 1 // Current revision level
	SID_MAX_SUB_AUTHORITIES         = 15
	SID_RECOMMENDED_SUB_AUTHORITIES = 1 // Will change to around 6
)

// in a future release.
const SECURITY_MAX_SID_SIZE = (12 /*sizeof(SID)*/ - 4 /*sizeof(uint32)*/ + (SID_MAX_SUB_AUTHORITIES * 4 /*sizeof(uint32)*/))

type SID_NAME_USE uint32

const (
	SidTypeUser           SID_NAME_USE = 1
	SidTypeGroup          SID_NAME_USE = 2
	SidTypeDomain         SID_NAME_USE = 3
	SidTypeAlias          SID_NAME_USE = 4
	SidTypeWellKnownGroup SID_NAME_USE = 5
	SidTypeDeletedAccount SID_NAME_USE = 6
	SidTypeInvalid        SID_NAME_USE = 7
	SidTypeUnknown        SID_NAME_USE = 8
	SidTypeComputer       SID_NAME_USE = 9
	SidTypeLabel          SID_NAME_USE = 10
)

type SID_AND_ATTRIBUTES struct {
	Sid        unsafe.Pointer
	Attributes uint32
}

//
// Token information class structures
//

type TOKEN_USER struct {
	User SID_AND_ATTRIBUTES
}

//
// Token Information Classes.
//

type TOKEN_INFORMATION_CLASS uint32

const (
	TokenUser                  TOKEN_INFORMATION_CLASS = 1
	TokenGroups                TOKEN_INFORMATION_CLASS = 2
	TokenPrivileges            TOKEN_INFORMATION_CLASS = 3
	TokenOwner                 TOKEN_INFORMATION_CLASS = 4
	TokenPrimaryGroup          TOKEN_INFORMATION_CLASS = 5
	TokenDefaultDacl           TOKEN_INFORMATION_CLASS = 6
	TokenSource                TOKEN_INFORMATION_CLASS = 7
	TokenType                  TOKEN_INFORMATION_CLASS = 8
	TokenImpersonationLevel    TOKEN_INFORMATION_CLASS = 9
	TokenStatistics            TOKEN_INFORMATION_CLASS = 10
	TokenRestrictedSids        TOKEN_INFORMATION_CLASS = 11
	TokenSessionId             TOKEN_INFORMATION_CLASS = 12
	TokenGroupsAndPrivileges   TOKEN_INFORMATION_CLASS = 13
	TokenSessionReference      TOKEN_INFORMATION_CLASS = 14
	TokenSandBoxInert          TOKEN_INFORMATION_CLASS = 15
	TokenAuditPolicy           TOKEN_INFORMATION_CLASS = 16
	TokenOrigin                TOKEN_INFORMATION_CLASS = 17
	TokenElevationType         TOKEN_INFORMATION_CLASS = 18
	TokenLinkedToken           TOKEN_INFORMATION_CLASS = 19
	TokenElevation             TOKEN_INFORMATION_CLASS = 20
	TokenHasRestrictions       TOKEN_INFORMATION_CLASS = 21
	TokenAccessInformation     TOKEN_INFORMATION_CLASS = 22
	TokenVirtualizationAllowed TOKEN_INFORMATION_CLASS = 23
	TokenVirtualizationEnabled TOKEN_INFORMATION_CLASS = 24
	TokenIntegrityLevel        TOKEN_INFORMATION_CLASS = 25
	TokenUIAccess              TOKEN_INFORMATION_CLASS = 26
	TokenMandatoryPolicy       TOKEN_INFORMATION_CLASS = 27
	TokenLogonSid              TOKEN_INFORMATION_CLASS = 28
	MaxTokenInfoClass          TOKEN_INFORMATION_CLASS = 256 // MaxTokenInfoClass should always be the last enum
)
